# คู่มือการใช้งาน TPAK DQ System v3

## การติดตั้ง

### ความต้องการระบบ
- WordPress 5.0 หรือใหม่กว่า
- PHP 7.4 หรือใหม่กว่า
- MySQL 5.7 หรือใหม่กว่า
- การเข้าถึง LimeSurvey API

### ขั้นตอนการติดตั้ง

1. **อัปโหลดปลั๊กอิน**
   - อัปโหลดโฟลเดอร์ `tpak-dq-system` ไปยัง `/wp-content/plugins/`
   - หรือใช้ WordPress Plugin Uploader

2. **เปิดใช้งานปลั๊กอิน**
   - ไปที่ WordPress Admin > Plugins
   - คลิก "Activate" สำหรับ TPAK DQ System v3

3. **ตั้งค่าเริ่มต้น**
   - ไปที่ TPAK DQ > Settings
   - กรอกข้อมูล LimeSurvey API
   - ทดสอบการเชื่อมต่อ

## การตั้งค่า

### LimeSurvey API Configuration

1. **API URL**
   ```
   https://your-limesurvey-domain.com/admin/remotecontrol
   ```

2. **Username**
   - ใช้ username ของ LimeSurvey admin

3. **Password**
   - ใช้ password ของ LimeSurvey admin

4. **ทดสอบการเชื่อมต่อ**
   - คลิก "Test Connection" เพื่อตรวจสอบการตั้งค่า

### การตั้งค่าอื่นๆ

- **Auto Sync Interval**: ความถี่ในการ sync ข้อมูลจาก LimeSurvey
- **Quality Check Enabled**: เปิด/ปิดการตรวจสอบคุณภาพข้อมูล
- **Report Auto Generate**: เปิด/ปิดการสร้างรายงานอัตโนมัติ
- **Notification Email**: อีเมลสำหรับการแจ้งเตือน

## การใช้งาน

### Dashboard

Dashboard แสดงข้อมูลสรุปของระบบ:
- จำนวนแบบสอบถามทั้งหมด
- แบบสอบถามที่ใช้งานอยู่
- จำนวนการตรวจสอบทั้งหมด
- อัตราการผ่านการตรวจสอบ

### การจัดการแบบสอบถาม

1. **Sync แบบสอบถาม**
   - คลิก "Sync Questionnaires" เพื่อดึงข้อมูลจาก LimeSurvey
   - ระบบจะอัปเดตแบบสอบถามที่มีอยู่และเพิ่มแบบสอบถามใหม่

2. **ดูรายละเอียดแบบสอบถาม**
   - คลิกที่ชื่อแบบสอบถามเพื่อดูรายละเอียด
   - ดูสถิติและคำถามของแบบสอบถาม

3. **รันการตรวจสอบคุณภาพข้อมูล**
   - คลิก "Run Quality Checks" เพื่อตรวจสอบข้อมูล

### การตั้งค่าการตรวจสอบคุณภาพข้อมูล

#### ประเภทการตรวจสอบ

1. **Completeness (ความสมบูรณ์)**
   - ตรวจสอบว่าฟิลด์ที่จำเป็นถูกกรอกครบหรือไม่
   - ตั้งค่า: ระบุฟิลด์ที่จำเป็น

2. **Consistency (ความสอดคล้อง)**
   - ตรวจสอบความสอดคล้องระหว่างฟิลด์
   - ตั้งค่า: ระบุกฎความสอดคล้อง

3. **Validity (ความถูกต้อง)**
   - ตรวจสอบรูปแบบข้อมูล (email, URL, วันที่)
   - ตั้งค่า: ระบุประเภทข้อมูลและกฎการตรวจสอบ

4. **Accuracy (ความแม่นยำ)**
   - ตรวจสอบความแม่นยำของข้อมูล
   - ตั้งค่า: ระบุช่วงค่าที่ยอมรับได้

5. **Timeliness (ความทันสมัย)**
   - ตรวจสอบความทันสมัยของข้อมูล
   - ตั้งค่า: ระบุช่วงเวลาที่ยอมรับได้

6. **Uniqueness (ความไม่ซ้ำกัน)**
   - ตรวจสอบความไม่ซ้ำกันของข้อมูล
   - ตั้งค่า: ระบุฟิลด์ที่ต้องไม่ซ้ำ

7. **Custom (กำหนดเอง)**
   - สร้างกฎการตรวจสอบแบบกำหนดเอง
   - ตั้งค่า: เขียน expression สำหรับการตรวจสอบ

#### การตั้งค่าการตรวจสอบ

1. **เลือกแบบสอบถาม**
   - เลือกแบบสอบถามที่ต้องการตรวจสอบ

2. **เลือกประเภทการตรวจสอบ**
   - เลือกประเภทการตรวจสอบที่ต้องการ

3. **ตั้งค่าการตรวจสอบ**
   - กรอกข้อมูลตามประเภทการตรวจสอบที่เลือก

4. **เปิดใช้งาน**
   - เปิดใช้งานการตรวจสอบ

### การดูรายงาน

#### ประเภทรายงาน

1. **รายงานสรุป**
   - แสดงสถิติโดยรวมของระบบ
   - กราฟแสดงแนวโน้มการตรวจสอบ

2. **รายงานตามแบบสอบถาม**
   - แสดงผลการตรวจสอบของแบบสอบถามเฉพาะ
   - กราฟแสดงผลการตรวจสอบตามประเภท

3. **รายงานตามช่วงเวลา**
   - แสดงผลการตรวจสอบตามช่วงเวลา
   - เปรียบเทียบผลการตรวจสอบ

#### การ Export รายงาน

1. **CSV Format**
   - เหมาะสำหรับการวิเคราะห์ใน Excel
   - ประกอบด้วยข้อมูลสถิติและผลการตรวจสอบ

2. **JSON Format**
   - เหมาะสำหรับการประมวลผลด้วยโปรแกรม
   - ประกอบด้วยข้อมูลครบถ้วน

3. **PDF Format**
   - เหมาะสำหรับการพิมพ์และแชร์
   - ประกอบด้วยกราฟและตาราง

### Shortcodes

#### แสดงรายการแบบสอบถาม
```
[tpak_questionnaire_list status="active" limit="10" show_description="true"]
```

**พารามิเตอร์:**
- `status`: สถานะแบบสอบถาม (active, inactive, all)
- `limit`: จำนวนแบบสอบถามที่แสดง
- `show_description`: แสดงคำอธิบาย (true/false)
- `show_statistics`: แสดงสถิติ (true/false)

#### แสดงรายงานคุณภาพข้อมูล
```
[tpak_quality_report questionnaire_id="1" period="month" show_chart="true"]
```

**พารามิเตอร์:**
- `questionnaire_id`: ID ของแบบสอบถาม (0 = ทั้งหมด)
- `period`: ช่วงเวลา (day, week, month, quarter, year)
- `show_chart`: แสดงกราฟ (true/false)
- `show_details`: แสดงรายละเอียด (true/false)

#### แสดง Dashboard คุณภาพข้อมูล
```
[tpak_quality_dashboard show_summary="true" show_charts="true"]
```

**พารามิเตอร์:**
- `show_summary`: แสดงสรุป (true/false)
- `show_charts`: แสดงกราฟ (true/false)
- `show_recent_checks`: แสดงการตรวจสอบล่าสุด (true/false)

## การบำรุงรักษา

### การ Backup

1. **Backup ฐานข้อมูล**
   - Export ตาราง `wp_tpak_*`
   - Backup WordPress options ที่ขึ้นต้นด้วย `tpak_dq_`

2. **Backup ไฟล์**
   - Backup โฟลเดอร์ปลั๊กอิน
   - Backup ไฟล์การตั้งค่า

### การอัปเดต

1. **Backup ข้อมูลก่อนอัปเดต**
2. **อัปเดตปลั๊กอิน**
3. **ตรวจสอบการทำงานหลังอัปเดต**

### การแก้ไขปัญหา

#### ปัญหาการเชื่อมต่อ LimeSurvey
1. ตรวจสอบ API URL
2. ตรวจสอบ Username และ Password
3. ตรวจสอบการเข้าถึง API จากเซิร์ฟเวอร์

#### ปัญหาการตรวจสอบคุณภาพข้อมูล
1. ตรวจสอบการตั้งค่าการตรวจสอบ
2. ตรวจสอบข้อมูลใน LimeSurvey
3. ดู log ข้อผิดพลาด

#### ปัญหาการแสดงผล
1. ตรวจสอบ JavaScript Console
2. ตรวจสอบ CSS conflicts
3. ตรวจสอบ WordPress theme compatibility

## การพัฒนา

### การเพิ่มประเภทการตรวจสอบใหม่

1. เพิ่ม method ใน `TPAK_Data_Quality_Checker`
2. เพิ่ม UI ใน admin panel
3. เพิ่มการจัดการใน database

### การเพิ่มรายงานใหม่

1. เพิ่ม method ใน `TPAK_Report_Generator`
2. เพิ่ม UI ใน admin panel
3. เพิ่ม shortcode สำหรับแสดงผล

### การปรับแต่ง UI

1. แก้ไขไฟล์ CSS ใน `assets/css/`
2. แก้ไขไฟล์ JavaScript ใน `assets/js/`
3. แก้ไขไฟล์ template ใน `admin/views/` และ `public/views/`

## การสนับสนุน

สำหรับคำถามหรือปัญหาการใช้งาน กรุณาติดต่อ:
- Email: support@tpak.org
- Documentation: https://docs.tpak.org/dq-system
- GitHub Issues: https://github.com/tpak/dq-system/issues 